{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# üå¶ –ê–Ω–∞–ª–∏–∑ –ø–æ–≥–æ–¥—ã –≤ –ú–æ—Å–∫–≤–µ, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ –∏ –°–∞–º–∞—Ä–µ\n",
    "### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Ç–µ–æ–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import plotly.express as px\n",
    "import plotly.graph_objects as go\n",
    "from plotly.subplots import make_subplots\n",
    "from IPython.display import display, HTML\n",
    "\n",
    "# –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞\n",
    "display(HTML('''\n",
    "<style>\n",
    ".header {\n",
    "    color: #3498db;\n",
    "    font-family: Arial;\n",
    "    text-align: center;\n",
    "}\n",
    ".plot-container {\n",
    "    margin: 20px 0;\n",
    "    border: 1px solid #eee;\n",
    "    border-radius: 5px;\n",
    "    padding: 10px;\n",
    "}\n",
    "</style>\n",
    "'''))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## üìà –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–µ–æ–ø–∞—Ä–∞–º–µ—Ç—Ä—ã"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# –°–æ–∑–¥–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å —Å 4 –≥—Ä–∞—Ñ–∏–∫–∞–º–∏\n",
    "fig = make_subplots(\n",
    "    rows=2, cols=2,\n",
    "    subplot_titles=(\"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞\", \"–í–ª–∞–∂–Ω–æ—Å—Ç—å\", \"–ê—Ç–º. –¥–∞–≤–ª–µ–Ω–∏–µ\", \"–û—Å–∞–¥–∫–∏\")\n",
    ")\n",
    "\n",
    "# –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏\n",
    "for city in weather['city'].unique():\n",
    "    city_data = weather[weather['city'] == city]\n",
    "    \n",
    "    fig.add_trace(\n",
    "        go.Scatter(x=city_data['datetime'], y=city_data['temp_c'], name=f\"{city} - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞\"),\n",
    "        row=1, col=1\n",
    "    )\n",
    "    \n",
    "    fig.add_trace(\n",
    "        go.Scatter(x=city_data['datetime'], y=city_data['humidity'], name=f\"{city} - –í–ª–∞–∂–Ω–æ—Å—Ç—å\"),\n",
    "        row=1, col=2\n",
    "    )\n",
    "    \n",
    "    fig.add_trace(\n",
    "        go.Scatter(x=city_data['datetime'], y=city_data['pressure'], name=f\"{city} - –î–∞–≤–ª–µ–Ω–∏–µ\"),\n",
    "        row=2, col=1\n",
    "    )\n",
    "    \n",
    "    fig.add_trace(\n",
    "        go.Bar(x=city_data['datetime'], y=city_data['rain_mm'], name=f\"{city} - –û—Å–∞–¥–∫–∏\"),\n",
    "        row=2, col=2\n",
    "    )\n",
    "\n",
    "# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è\n",
    "fig.update_layout(\n",
    "    height=800,\n",
    "    title_text=\"<b>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–µ–æ–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</b>\",\n",
    "    hovermode=\"x unified\",\n",
    "    template=\"plotly_white\"\n",
    ")\n",
    "\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## üå°Ô∏è –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "fig = px.imshow(\n",
    "    pd.pivot_table(weather, values='temp_c', index='city', columns='datetime'),\n",
    "    labels=dict(x=\"–î–∞—Ç–∞\", y=\"–ì–æ—Ä–æ–¥\", color=\"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞\"),\n",
    "    color_continuous_scale='RdBu_r',\n",
    "    title='<b>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –ø–æ –¥–Ω—è–º</b>'\n",
    ")\n",
    "fig.update_xaxes(side=\"top\")\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## üåÄ –í–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "fig = px.scatter_polar(\n",
    "    weather, \n",
    "    r=\"wind_speed_kmh\", \n",
    "    theta=\"datetime\",\n",
    "    color=\"city\", \n",
    "    symbol=\"city\",\n",
    "    title=\"<b>–†–æ–∑–∞ –≤–µ—Ç—Ä–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º</b>\",\n",
    "    template=\"plotly_dark\"\n",
    ")\n",
    "fig.update_traces(\n",
    "    marker=dict(size=8, line=dict(width=1, color='DarkSlateGrey'))\n",
    ")\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# –°–æ–∑–¥–∞–µ–º –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏\n",
    "stats = weather.groupby('city').agg({\n",
    "    'temp_c': ['mean', 'max', 'min'],\n",
    "    'humidity': 'mean',\n",
    "    'wind_speed_kmh': 'max',\n",
    "    'rain_mm': 'sum'\n",
    "}).round(1)\n",
    "\n",
    "fig = go.Figure(data=[go.Table(\n",
    "    header=dict(\n",
    "        values=['–ì–æ—Ä–æ–¥', '–°—Ä. —Ç–µ–º–ø.', '–ú–∞–∫—Å. —Ç–µ–º–ø.', '–ú–∏–Ω. —Ç–µ–º–ø.', '–í–ª–∞–∂–Ω–æ—Å—Ç—å', '–ú–∞–∫—Å. –≤–µ—Ç–µ—Ä', '–û—Å–∞–¥–∫–∏'],\n",
    "        fill_color='#3498db',\n",
    "        font=dict(color='white', size=12)\n",
    "    ),\n",
    "    cells=dict(\n",
    "        values=[stats.index] + [stats[col] for col in stats.columns],\n",
    "        fill_color='lavender',\n",
    "        align='center'\n",
    "    ))\n",
    "])\n",
    "\n",
    "fig.update_layout(\n",
    "    title='<b>–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º</b>',\n",
    "    margin=dict(l=0, r=0, b=0)\n",
    ")\n",
    "\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## üîç –í—ã–≤–æ–¥—ã"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1. **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π —Ä–µ–∂–∏–º**:\n",
    "   - –ù–∞–∏–±–æ–ª–µ–µ —Ç–µ–ø–ª—ã–π –≥–æ—Ä–æ–¥: –°–∞–º–∞—Ä–∞ (—Å—Ä–µ–¥–Ω—è—è t¬∞ = {{—Å–∞–º–∞—Ä–∞_—Å—Ä_temp}}¬∞C)\n",
    "   - –ù–∞–∏–±–æ–ª–µ–µ —Ö–æ–ª–æ–¥–Ω—ã–π –≥–æ—Ä–æ–¥: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ (—Å—Ä–µ–¥–Ω—è—è t¬∞ = {{—Å–ø–±_—Å—Ä_temp}}¬∞C)\n",
    "   \n",
    "2. **–û—Å–∞–¥–∫–∏**:\n",
    "   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏: –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ ({{—Å–ø–±_rain}} –º–º)\n",
    "   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –æ—Å–∞–¥–∫–∏: –°–∞–º–∞—Ä–∞ ({{—Å–∞–º–∞—Ä–∞_rain}} –º–º)\n",
    "   \n",
    "3. **–í–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è**:\n",
    "   - –°–∞–º—ã–µ —Å–∏–ª—å–Ω—ã–µ –≤–µ—Ç—Ä–∞: –ú–æ—Å–∫–≤–∞ (–¥–æ {{–º–æ—Å–∫–≤–∞_–≤–µ—Ç–µ—Ä}} –∫–º/—á)\n",
    "   - –ù–∞–∏–±–æ–ª–µ–µ —Å–ø–æ–∫–æ–π–Ω—ã–µ —É—Å–ª–æ–≤–∏—è: –°–∞–º–∞—Ä–∞"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
